package com.example.leave.request.serviceImpl;

import java.util.ArrayList;
import java.util.List;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;

import com.example.leave.request.model.Employee;
import com.example.leave.request.model.LeaveRequest;
import com.example.leave.request.model.Manager;
import com.example.leave.request.repository.EmployeeRepo;
import com.example.leave.request.repository.LeaveRequestRepository;
import com.example.leave.request.repository.ManagerRepository;
import com.example.leave.request.service.LeaveRequestService;


@Service
public class LeaveRequestServiceImpl implements LeaveRequestService{
	
	@Autowired
	private LeaveRequestRepository repo;
	
	@Autowired
	private EmployeeRepo employeeRepo;
	
	@Autowired 
	private ManagerRepository managerRepo;
	
	public LeaveRequestServiceImpl(LeaveRequestRepository repo) {
		super();
		this.repo = repo;
	}
	
	




//	public LeaveRequestServiceImpl(EmployeeRepo employeeRpo) {
//		super();
//		this.employeeRpo = employeeRpo;
//	}






	@Override
	public LeaveRequest createRequest(LeaveRequest leave) {
		leave.setStatus("Pending");
		return repo.save(leave);		
	}







	public boolean applyforLeave(LeaveRequest l, String employeeMail, String mail) {
		Optional<Employee> empexists = employeeRepo.findByEmployeeMail(l.getEmployeeMail());
		Optional<Manager> managerexists = managerRepo.findByMail(l.getMail());
		
		if(!empexists.isPresent() || !managerexists.isPresent()) {
			System.out.println("Either employee or manager does not exists");
			retun false;
		}
		l.setStatus("Pending");
		 repo.save(l);
		 return true;
		
		
		
	}


//	@Override
//	public LeaveRequest updateRequest(LeaveRequest l, String employeeMail) {
//		// TODO Auto-generated method stub
//		return null;
//	}




//	List<LeaveRequest> requests = new ArrayList<>();
//	@Override
//	public LeaveRequest checkStatus(LeaveRequest l, String employeeMail) {
//		
//		for(LeaveRequest request : requests) {
//			if(request.getEmployeeMail().equals(employeeMail)) {
//				System.out.println("approved");
//				return request;
//			}
//		}
//		
//		return null;
//		
//	}





	
}
